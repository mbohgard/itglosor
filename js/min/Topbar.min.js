define(["lib/jquery"],function(){var e,t,n,r,i,s,o,u,a=!1,f=function(){o=t.height();t.css({height:o,top:-o,opacity:1})},l=function(e){c();h();if(e){m();g(!0);$("html").on("click",function(e){$(e.target).parents("#topbar").length||l(!1)});a=!0}else{r.removeClass("is-active");v(!1);g(!1);$("html").off("click");a=!1}},c=function(){e.find(".page-title").toggleClass("is-dimmed")},h=function(){var t,r,i;if(a===!1){t=e.find(".header-content").outerWidth();r=n.outerWidth();i=i=t/2-r/2;n.css({transform:"translate(-"+i+"px, 0px)"})}else n.css({transform:"translate(0,0)"})},p=function(){var t=e.find(".header-content").offset().left,n=s.offset().left,r=i.position().left;return t-r+n},d=function(){var e=p();s.css({transform:"translate("+e+"px,0)"});i.addClass("is-visible").siblings().removeClass("is-visible")},v=function(n){var r=t.add(e),s;r.toggleClass("is-expanded",n);s=r.hasClass("is-expanded")?i.outerHeight():0;r.css({transform:"translate(0, "+s+"px"})},m=function(){if(!u){u=$('<a class="hidden-info-close" />');u.append('<i class="icon-remove" />');u.appendTo("body")}},g=function(e){var t=e?400:250,n=setTimeout(function(){u.toggleClass("is-visible",e)},t)},y=function(){r.on("click",function(){var e=$(this);i=s.find(e.attr("href"));a===!1&&l(!0);r.removeClass("is-active");e.addClass("is-active");d();v(!0);return!1})};return{init:function(i){console.log("Topbar initialized");e=i.header;t=i.hiddenInfo;n=e.find("nav");r=n.find("a");s=t.find(".hidden-info-wrapper");y();f()}}});